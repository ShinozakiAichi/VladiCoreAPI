### Register
POST http://localhost:5200/auth/register
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "P@ssw0rd!",
  "displayName": "Demo User"
}

### Login
POST http://localhost:5200/auth/login
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "P@ssw0rd!"
}

### Refresh token
POST http://localhost:5200/auth/refresh
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "refreshToken": "{{refreshToken}}"
}

### Get profile
GET http://localhost:5200/me
Authorization: Bearer {{accessToken}}

### Update profile
PUT http://localhost:5200/me
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "displayName": "Updated User",
  "phoneNumber": "+1234567890"
}

### List products
GET http://localhost:5200/products?categoryId=1&minPrice=100&sort=-created&page=1&pageSize=10
Accept: application/json

### Product details
GET http://localhost:5200/products/1
Accept: application/json

### Price history
GET http://localhost:5200/products/1/price-history?bucket=day&from={{from}}&to={{to}}
Accept: application/json

### Recommendations
GET http://localhost:5200/products/1/recommendations?take=5
Accept: application/json

### Admin create product
POST http://localhost:5200/products
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "sku": "NEW-001",
  "name": "Новый продукт",
  "categoryId": 1,
  "price": 199.99,
  "stock": 25,
  "description": "Описание товара",
  "specs": {
    "color": "black",
    "warranty": "2y"
  }
}

### Admin update product
PUT http://localhost:5200/products/1
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "sku": "CPU-5600X",
  "name": "AMD Ryzen 5 5600X",
  "categoryId": 1,
  "price": 239.99,
  "stock": 42,
  "description": "Обновленное описание",
  "specs": {
    "componentType": "cpu",
    "componentId": 1
  }
}

### Admin delete product
DELETE http://localhost:5200/products/11
Authorization: Bearer {{adminToken}}

### Request presign for product image
POST http://localhost:5200/storage/presign
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "type": "products",
  "contentType": "image/jpeg",
  "size": 4000000,
  "entityId": 1
}

### Confirm product photo
POST http://localhost:5200/products/1/photos
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "key": "products/1/{{objectKey}}",
  "etag": "{{etag}}",
  "sortOrder": 0
}

### List product reviews
GET http://localhost:5200/api/products/1/reviews?skip=0&take=10&sort=-createdAt
Accept: application/json

### Create review
POST http://localhost:5200/api/products/1/reviews
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "rating": 5,
  "title": "Отличный товар",
  "text": "Стабильно работает, рекомендую",
  "photos": ["reviews/10/photo.jpg"]
}

### Patch review
PATCH http://localhost:5200/api/products/1/reviews/1
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "rating": 4,
  "title": "Обновленный отзыв",
  "text": "После месяца использования всё ещё доволен",
  "photos": []
}

### Delete review (owner or admin)
DELETE http://localhost:5200/api/products/1/reviews/1
Authorization: Bearer {{accessToken}}

### Request presign for review photo
POST http://localhost:5200/storage/presign
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "type": "reviews",
  "contentType": "image/png",
  "size": 2000000,
  "entityId": 1
}

### Attach review photo
POST http://localhost:5200/api/products/1/reviews/1/photos
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "key": "reviews/1/{{objectKey}}",
  "etag": "{{etag}}"
}

### Vote review helpfulness
POST http://localhost:5200/api/products/1/reviews/1/vote
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "value": "up"
}

### Review moderation queue
GET http://localhost:5200/api/reviews/moderation?status=Pending&skip=0&take=20
Authorization: Bearer {{adminToken}}

### Approve review
POST http://localhost:5200/api/reviews/1/approve
Authorization: Bearer {{adminToken}}

### Reject review
POST http://localhost:5200/api/reviews/1/reject
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "reason": "spam",
  "note": "Detected promotional content"
}

### Admin block user
POST http://localhost:5200/users/{{userId}}/block
Authorization: Bearer {{adminToken}}

### Admin unblock user
DELETE http://localhost:5200/users/{{userId}}/block
Authorization: Bearer {{adminToken}}
